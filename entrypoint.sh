#!/bin/bash

cat << "EOF"


⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⣠⣤⣶⣶⣿⣿⣶⣿⣿⣿⣿⣿⣿⡶⣾⣿⣿⣿⣿⣶⣶⣤⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡀⠀⣠⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⢹⣿⣿⣧⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣦⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⣾⣿⡟⢿⣿⣿⣿⡿⠿⠿⠛⡛⣛⢛⡛⢛⠛⠿⠿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣤⣄⣀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⣿⣿⣿⣿⡿⢞⣋⢩⡐⢲⢸⢡⠏⡴⢃⡎⡜⣡⢋⡼⠱⣄⠲⡠⢎⡭⣉⢙⡛⡻⠿⣿⣿⣿⡿⣻⣿⣿⣿⣷⣄⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣤⣾⣷⡽⢛⠥⣒⠥⣊⠦⣙⠬⣒⢣⠚⣥⠃⡘⡜⢤⡓⢬⡓⢬⣃⢇⠳⡰⢍⠦⢣⡑⣆⠒⣍⠛⠾⣿⣿⣿⣿⣿⣿⣷⣄⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣾⡿⢛⠥⢪⠜⣢⠕⣚⠤⢫⠔⡫⡔⢫⡱⠂⡰⡑⢈⢦⡙⢦⡙⡲⢌⡎⢳⣉⠮⣱⠣⣕⢪⢹⠰⣊⠑⡨⠛⢿⣿⣿⣿⣿⣿⡆⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⡾⢋⠴⡱⢉⡆⡝⢢⠝⡌⢠⠊⡕⢣⢍⡣⠂⡜⡁⢠⠃⡰⣩⢒⡱⢍⡆⢘⢣⣌⠳⢢⡝⢤⡃⢧⠓⡆⢆⠱⢪⡈⠹⣿⣿⣿⣿⣿⣤
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣸⠏⡰⣁⠷⢁⡏⢶⠉⣇⠶⢀⢇⠸⡈⢇⡎⡀⢸⡰⠁⢇⠁⡶⢁⡏⢶⢁⡎⠈⡶⡈⡇⢷⠸⣆⠹⡆⢿⡸⡈⡀⢇⠹⣀⠈⣿⡿⣱⣿⣿
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢉⠞⡰⣅⠊⡰⢜⢪⡙⡤⢃⠸⣌⢣⡙⣌⠒⢠⢣⡑⢨⠎⠠⣍⢣⠜⣢⢋⡜⠀⣇⢳⣉⠦⠘⡤⢛⡜⡢⠵⣡⢣⠈⡵⢨⢅⡘⣿⣿⣿⣿
⠀⠀⠀⠀⠀⠀⠀⠀⠀⣰⢣⡙⢦⠁⡜⡱⢎⡱⢎⠆⣈⠳⣌⠲⡉⢀⡌⠀⡦⠅⠲⣌⠰⡌⣇⠚⡥⢊⡼⠀⡭⢲⢌⡳⡀⢇⡫⠴⣉⠷⣐⠣⢆⠱⣉⢖⡐⡘⣯⣽⣿
⠀⠀⠀⠀⠀⠀⠀⠀⢰⢡⠆⡙⠆⢰⡙⡜⣬⠱⢎⠀⢧⠹⡰⠋⢠⣾⣏⠰⣡⢋⠰⢄⠸⣰⡉⡞⡔⢫⠄⣠⠱⣩⠲⣡⢃⠸⡰⢋⡜⢆⡣⡝⢬⡀⢇⡚⠴⡁⢹⣿⣿
⠀⠀⠀⠀⠀⠀⠀⠀⣇⠀⢀⡹⠀⡇⢞⡱⢂⡏⠂⢘⡌⢧⠑⣠⣭⡻⠇⠸⣄⡋⠄⣊⠰⡅⢞⡱⢜⠣⢠⣿⡆⠂⣁⠦⡡⠰⡱⠂⡜⡱⢜⡸⢢⡅⠰⣉⠧⣙⠘⣿⣧
⠀⠀⠀⠀⠀⠀⠀⠐⠇⠀⠠⣙⠠⡝⣢⠕⣋⠀⣾⢀⠚⠄⣴⣿⣿⣿⣷⠀⡜⡬⡡⢐⠨⡜⢥⠚⠬⠁⣪⣥⣶⡌⢢⢣⠱⢀⢃⠇⢸⡑⢎⡱⢣⢜⠀⡓⣎⡱⠃⣿⣿
⠀⠀⠀⠀⠀⠀⠀⠘⠀⠀⠰⡡⢐⢣⡕⡚⠄⣼⣿⠠⠍⣰⣟⣛⣻⡿⢿⡎⡱⢒⠥⢲⡀⢎⢇⡫⠄⣾⣿⣿⠿⠿⡄⢃⠲⢸⣆⢃⠰⡩⢎⡱⢃⡎⠆⠱⢆⡹⠁⡿⣁
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡱⢈⠶⣘⠌⠰⡿⠟⠃⠀⣀⣀⣀⡉⠉⠙⠃⠸⣡⠀⠷⣀⢎⠞⠀⣼⣿⠟⠚⠉⢉⣉⣀⠁⠀⠀⠀⠨⠕⢎⡱⠣⢎⡑⢨⢣⡱⢣⡳⡥
⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⢎⡱⡀⠳⣸⠀⢱⠀⣠⣶⣿⡟⠁⠀⠀⠈⠑⢶⣆⠰⠀⢣⠍⡎⢂⣼⣿⣥⣴⣶⡋⠉⠀⠈⠉⠻⣷⣦⢀⠀⠈⡠⢆⢳⡘⢠⡓⡜⠬⣚⠵
⠀⠀⠀⠀⠀⠀⠀⠀⢀⡜⡢⠵⣑⡂⠡⠀⢸⡄⣿⣿⡟⠋⠀⠀⠀⠀⠀⢸⣿⣦⢘⡀⠏⢠⣾⣿⣿⣿⣿⠙⠋⠀⠀⠀⠀⠀⠘⣏⠸⠀⡰⢱⢪⡑⢎⠰⣡⠋⠑⣠⢐
⠀⠀⠀⠀⠀⠀⠀⠀⢢⠈⠵⣙⢤⡋⠄⠀⣿⣿⣿⣿⡇⣤⣖⢋⢟⣶⡆⣸⣿⣿⣿⣷⣴⣿⣿⣿⣿⣿⣿⡀⣤⣖⠲⠲⢦⣄⠘⡇⡍⡰⣑⣋⠦⣙⢎⠀⢕⡢⠝⡤⢋
⠀⢼⣿⣷⣄⠀⠀⢘⢲⠀⢳⡘⠦⢉⠆⢀⣿⣿⣿⣿⣷⣌⣚⡬⣜⣪⣼⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣅⡫⠵⠉⠫⢏⣼⠇⡴⢱⡡⢎⠼⡡⢞⠠⣶⡈⡝⢲⡩
⠀⠀⢿⣿⣿⣆⠀⢘⡌⠀⢣⡙⢢⠀⠓⡸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡟⠰⡡⠇⡸⢡⡓⡍⣎⢸⣿⡇⢸⡱⢜
⠀⠀⠀⢿⣿⣿⣆⠐⠆⠀⠀⡝⢦⠀⠀⢁⠹⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠇⢣⠑⠠⣓⢣⡙⠀⠆⣼⣿⠇⠣⡜⢎
⠀⠀⠀⠈⣿⣿⣿⡆⠀⠀⠀⠈⢖⡀⠀⠀⠹⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⢿⣿⣿⣿⣿⣿⣿⣿⣿⠿⣛⣡⣿⣿⣿⣿⣿⡟⡈⢡⢀⠳⣌⠣⢠⡇⢢⠿⢋⣌⠳⣘⢣
⠀⠀⠀⠀⠈⣿⣿⣿⢀⣀⡀⣀⣀⠁⠀⠰⠏⡆⠉⣰⣆⠹⣿⣿⣿⣿⣿⣿⣷⣉⣿⣿⣿⢿⣏⣉⣶⣿⣿⣿⣿⣿⣿⣿⣿⢀⣶⡏⡀⢏⡰⠁⠏⠁⠀⢾⡰⢎⢱⠉⡶
⠀⠀⠀⣠⣴⢹⣿⣣⣿⣿⣰⣿⣿⢷⣄⠈⠚⠘⠠⠿⠿⠷⠶⡨⡻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠟⣠⠙⠂⠀⡄⠂⡔⠨⢰⠱⣊⢥⠛⡴
⠀⠀⠀⣿⣿⣾⣿⣿⣿⣿⣿⣿⣿⣮⠻⠀⠀⠀⠀⠀⠀⠀⠀⠀⢻⣮⠉⢛⣛⡻⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠿⢛⣫⣥⣦⣀⠀⡐⣈⠒⡀⠐⡈⢆⠡⣏⢜⢢⠛⡴
⠀⠀⠀⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⠀⠀⠀⠀⠀⠠⠀⠀⠀⠀⢻⣧⣧⡝⣿⣿⣾⣼⣝⡻⣿⣿⡿⢫⣶⣶⢊⢿⣿⣿⣿⣿⡇⠐⠄⢢⠁⠠⢑⠠⠓⣌⠮⣡⠇⢸
⠀⠀⠀⠙⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⢸⣄⠀⠀⠀⠀⠄⠀⠀⠀⣿⣿⣸⣷⠈⠻⣿⣿⣿⣿⣶⣶⠚⣿⣿⣿⢸⣆⣿⣿⣿⣿⣧⢈⠘⡄⡘⠀⢌⠢⠑⣬⠒⡕⡺⠠
⠀⠀⠀⠀⠈⠻⣿⣿⣿⣿⣿⣿⣿⡿⠇⣽⠺⡀⠀⠀⠀⠀⠀⢀⣤⣽⣿⢸⣿⠀⠀⠉⢿⣿⣿⡿⠁⠀⠈⣿⣿⠀⣿⣿⣿⣿⣿⡿⠀⠢⡐⠰⠀⢊⠰⢉⠦⡁⢞⡡⢇
⠀⠀⠀⠀⠀⠀⠈⠛⠫⢽⣛⣭⡴⢞⣵⠟⡜⠀⠀⠀⠀⠀⠀⣾⣿⣿⡟⣸⣿⠀⠀⠀⠀⠘⠻⠁⠀⠀⠀⠘⡇⠀⢸⣿⣿⣿⣿⡄⠀⠐⠡⡑⡀⠅⡊⢄⠳⡈⠴⣡⢋
⠀⠀⠀⠀⠀⠀⠀⠈⠒⠤⠐⡤⠔⠛⠅⠊⠀⠀⠀⠀⠂⠈⠀⠸⣿⣿⣧⣿⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⣿⣿⣿⡇⠀⠀⠡⠐⡄⢃⠌⡂⢇⠰⢁⠧⣩

EOF

echo "configuring ngrok authoken...."

ngrok config add-authtoken $NGROK_AUTHTOKEN

# Start the FastAPI server using Uvicorn in the background
uvicorn main:app --host 0.0.0.0 --port 8000 &

# Pause for a few seconds to allow the API server to start
sleep 3

# Start ngrok to tunnel HTTP traffic on port 8000 in the background
/usr/local/bin/ngrok http 8000 &

# Give ngrok a few seconds to initialize
sleep 5

# Retrieve the public URL from ngrok's API and print it
curl --silent http://localhost:4040/api/tunnels | grep -o "https://[^\"]*"

# Wait indefinitely so the container keeps running
wait
